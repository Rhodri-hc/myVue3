<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vue3</title>
</head>
<body>
    <div id="text"></div>

    <script src="./proxy.js"></script>
    <script src="./computed.js"></script>
    <script src="./watch.js"></script>
    <script>
        // const response = {
        //     foo: 1
        // }
        // const proxyData =  buildResponsiveProxy(response)
        
        // effect(() => {
        //     console.log(proxyData.foo);
        // }, {
        //     scheduler(fn){
        //         // 每次调度时，将副作用函数添加到jobQueue队列中
        //         jobQueue.add(fn);
        //         // 调用flushJob 刷新队列
        //         flushJob()
        //     }
        // })
        
        
        // proxyData.foo++
        // proxyData.foo++
        // proxyData.foo++
        
        // console.log("依赖收集完成");

        // 计算属性
        // const data = { foo: 1, bar: 2 };
        // const obj = buildResponsiveProxy(data)

        // const sumRes = computed(() => obj.foo + obj.bar)

        // // console.log("不在effect内", sumRes.value);
        
        // effect(() => {
        //     console.log(sumRes.value);
        // })
        // // 修改obj.foo 值
        // obj.foo++;

        // watch 监听
        const data = { foo: 1, bar: 2 };
        const obj = buildResponsiveProxy(data);
        watch(obj, (newVal,oldVal) => {
            console.log('变化了',newVal.foo ,oldVal)
        },{
            // 回调函数会在watch 创建时立即执行一次
            // flush: 'post', // 还可以指定为 'post' | 'sync'
            immediate: true
        });
       
    </script>
</body>
</html>